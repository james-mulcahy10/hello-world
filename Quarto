---
title: "Unicef Indicator Visualization"
output:
  html_document:
    df_print: paged
---

```{r}
#reading data from csv file
data <- read.csv("unicef_indicator_1.csv")
head(data)
```



### 1. World Map Chart


```{r, warning=FALSE, message=FALSE}
# Import required libraries
library(tidyverse)
library(rnaturalearth)
library(rnaturalearthdata)

# Process data for the most up-to-date year
current_data <- data %>%
  filter(time_period == max(time_period))

# Retrieve world map dataset
world_map <- ne_countries(scale = "medium", returnclass = "sf")

# Combine world map dataset with the current_data data frame
merged_data <- world_map %>%
  left_join(current_data, by = c("iso_a3" = "alpha_3_code"))

# Generate a world map chart with ggplot2
ggplot() +
  geom_sf(data = merged_data, aes(fill = obs_value), color = "black", size = 0.1) +
  scale_fill_viridis_c(option = "viridis", trans = "log10", na.value = "gray90",
                       labels = scales::comma_format(),
                       guide = guide_colorbar(title = "Proportion of population using safely \nmanaged sanitation services")) +
  labs(title = "Worldwide Proportion of population using safely managed sanitation services",
       subtitle = paste("Year:", max(current_data$time_period))) +
  theme_minimal() +
  theme(legend.position = "bottom",
        plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
        plot.subtitle = element_text(size = 12, face = "bold", hjust = 0.5))

```

The world map above shows the proportion of the population using safely managed sanitation services in 2020. It is clear to see from the map that a higher proportion of people in first world countries in Europe are using safely managed services as opposed to third world countries in parts of Africa

### 2. Bar Chart


```{r}
#Top 20 countries with highest proportion of population using safely managed sanitation services
#filtering top 20 countries
data2 <- data[data$time_period == max(data$time_period),]
data_arr <- data2 %>%
  group_by(country) %>%
  summarise(obs_value = sum(obs_value)) %>%
  arrange(desc(obs_value)) 
top20 <- data_arr[1:20,]
# Create a bar chart using ggplot2
ggplot(top20, aes(x = reorder(country, obs_value), y = obs_value, fill = country)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  labs(title = "Top 20 Countries with Highest population using safely managed \nsanitation services",
       x = "Country",
       y = "Population using safely managed sanitation services") +
  theme_minimal() +
  theme(legend.position = "none") + 
  coord_flip()
```

he bar chart above shows the top 20 countries with the highest percentage of their population using safely managed sanitation services. Singapore, Monaco and Kuwait are the top 3 countries.

### 3. Scatter Plot

```{r}
#scatter plot with regression line
data%>%
  group_by(time_period)%>%
  summarise(obs_value = median(obs_value))%>%
  ggplot(aes(x = time_period, y = obs_value)) +
  geom_point() +
  geom_smooth(formula = y ~ x, method = "lm") +
  labs(title = "Scatter plot for Proportion of population using safely managed sanitation services \nover Time") +
  theme_minimal()
```

The scatter plot above shows the proportion of the worlds population using safely manager sanitation services from the year 2000 to 2020. It is encouraging to see an upward trend with close to 20% more people now having access to safe sanitation services.


### 4. Time Series Plot

```{r}
data%>%
  group_by(time_period)%>%
  summarise(obs_value = mean(obs_value))%>%
  ggplot(aes(x = time_period, y = obs_value)) +
  geom_line(linewidth = 1) +
  labs(title = "Time Series plot for Proportion of population using safely managed sanitation services \nover Time") +
  theme_minimal()
```
The time series plot above also shows an upward curve in the amount of people using safely managed sanitation services from the year 2000 to 2020. Overall from the 4 graphs it is encourage to see safely managed sanitation services are slowly becoming more accessible to all.

